(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6289:(t,r,e)=>{Promise.resolve().then(e.bind(e,8438))},3411:(t,r,e)=>{"use strict";e.d(r,{dT:()=>i,pj:()=>o,zY:()=>n});var a=e(9632);async function o(t){let{userId:r,productId:e,quantity:o}=t;try{if(!await a.z.user.findUnique({where:{id:r}}))throw Error("User not found");if(!await a.z.product.findUnique({where:{id:e}}))throw Error("Product not found");let t=await a.z.cart.findUnique({where:{userId:r}});t||(t=await a.z.cart.create({data:{userId:r}}));let n=await a.z.cartItem.findFirst({where:{cartId:t.id,productId:e}});n?await a.z.cartItem.update({where:{id:n.id},data:{quantity:n.quantity+o}}):await a.z.cartItem.create({data:{cartId:t.id,productId:e,quantity:o}})}catch(t){throw console.error("Error adding to cart:",t),Error("Failed to add to cart")}}async function n(t,r){try{if(console.log("RemoveFromCart called with userId:",t,"and productId:",r),!await a.z.product.findUnique({where:{id:r}}))throw Error("Product not found");let e=await a.z.cart.findUnique({where:{userId:t}});if(!e)throw Error("Cart not found");await a.z.cartItem.deleteMany({where:{cartId:e.id,productId:r}}),console.log("Product removed successfully from cart")}catch(t){throw console.error("Error removing from cart:",t),Error("Failed to remove from cart")}}async function i(t){return(await a.z.cartItem.findMany({where:{cart:{userId:t}},include:{product:!0}})).map(t=>({id:t.id,productId:t.productId,quantity:t.quantity,price:t.product.price,product:{name:t.product.name}}))}},7582:(t,r,e)=>{"use strict";function a(t){try{localStorage.setItem("session",JSON.stringify(t))}catch(t){console.error("Error setting session:",t)}}function o(){try{let t=localStorage.getItem("session");return t?JSON.parse(t):null}catch(t){console.error("Error getting session:",t)}return null}function n(){try{localStorage.removeItem("session")}catch(t){console.error("Error clearing session:",t)}}e.d(r,{Ht:()=>o,Nq:()=>a,q7:()=>n})},8438:(t,r,e)=>{"use strict";e.d(r,{default:()=>d});var a=e(5155),o=e(8173),n=e.n(o),i=e(3411),c=e(7582);let d=function(t){let{title:r,description:e,id:o,price:d}=t,s=async()=>{let t=await (0,c.Ht)();if(!t){alert("Please log in to add items to the cart.");return}let r=t.UserId;try{await (0,i.pj)({userId:r,productId:o,quantity:1})}catch(t){console.error("Error adding to cart:",t)}};return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md m-4 hover:shadow-lg transition-shadow duration-300 w-[200px]",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-2",children:r}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:e}),(0,a.jsx)("p",{className:"text-lg font-bold text-gray-800 mb-4",children:d?"".concat(d.toFixed(2)," zÅ‚"):"Price not available"}),(0,a.jsx)(n(),{href:"/Pages/Posts/".concat(o),children:(0,a.jsx)("p",{className:"text-blue-500 hover:underline mb-4 block",children:"Read more about !"})}),(0,a.jsx)("button",{onClick:s,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition duration-300",children:"Add to Cart"})]})}},9632:(t,r,e)=>{"use strict";e.d(r,{z:()=>o});var a=e(1094);let o=e.g.prisma||new a.PrismaClient}},t=>{var r=r=>t(t.s=r);t.O(0,[94,173,441,517,358],()=>r(6289)),_N_E=t.O()}]);